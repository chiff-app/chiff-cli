import time


SEED = b"\xfe<u\xe8\xee\x8bV\x91\x12\xb0\xe0A\xad\x1d\x9b\xb6"
PAIRING_SEED = (
    b'\xf6\x8f\xb4\x96H"\x1e\xa0L\x8b>\xc0\xaf\x1c'
    b"\xf6!\xa0\n\xb9\xe5P\x9f\x11\x88\xaaJ\xe3\xe7\x87d\xa8\xf3"
)
PAIR_APP_PRIV_KEY = (
    b"\x8f\x06\xc0M\x02\x8f\t\xd56\xcc\xfdPK?\xc8\xd5"
    b"\x91O)\xf6\xed\x85/\x1d\xa6\xac\x00eI\xb6\xbeb"
)
PAIR_APP_PUB_KEY_B64 = "8EpIjeBw0Fbr9U4rSUc_M7ZlVaf-OMKgOjQjgKPX6WY"
PAIR_CLI_PRIV_KEY = (
    b"V\x97\xa0\xe8\xaa\x98\xf9\xf1\xe90\xd8\xc6\x04iS"
    b"\x89Q\xc8\x1fX\xcd\x9d\x05\xe8j\t\xa3\xd8\xe9\r:\xb4"
)
PAIR_CLI_PUB_KEY_B64 = "sIDpbe88kaBa1_q-TzIjgnMTUV50W13lfmVtcY3XMi0"
PUB_KEY = (
    b"\xc1\x1f\x83\xfe\xceP\x86\x06\x8d\xcf\xba0\xfc"
    b"\x15-B\xdc\x83\xf3D\xc0r\x0b.\x00\x1c\xf8\x1e~l\x06\x92"
)
BASE64_PUB_KEY = "wR-D_s5QhgaNz7ow_BUtQtyD80TAcgsuABz4Hn5sBpI"
DEFAULT_BASE64_PUB_KEY = "wR+D/s5QhgaNz7ow/BUtQtyD80TAcgsuABz4Hn5sBpI="
SHARED_KEY = (
    b"\xc2\xee\x153\xf7\xf6\xfd\xe4=/&\xbf"
    b"\xe8\x08\xe7\xc0\xb0\xcf}\x9e\x0f5\x94\xbc;\x89"
    b"\xf7\xd6\xe1\xf7^\xc8"
)
ECDSA_PUB_KEY = (
    b"\x04\x01\x92\xad\xb0\xa3\x86\x1a\x85\x1a\xe3"
    b"(\x14*:\xc6\x8c3pR\xf8\x93k)0B\xef\xd3\x9bg\xf6bS"
    b"|Lq\xe9\xee\x15Da\xb2f@\x97\xea\xa9\xf5\xbc7\xce]"
    b"\x9f\x9bG\x87\xbe\r&\xf1e4\xf6\xc6\xa8"
)
BASE64_ECDSA_PUB_KEY = (
    "BAGSrbCjhhqFGuMoFCo6xowzcFL4k2"
    "spMELv05tn9mJTfExx6e4VR"
    "GGyZkCX6qn1vDfOXZ-bR4e-DSbxZTT2xqg"
)
ECDSA_PRIV_KEY = (
    b"\x04\x01\x92\xad\xb0\xa3\x86\x1a\x85\x1a\xe3"
    b"(\x14*:\xc6\x8c3pR\xf8\x93k)0B\xef\xd3\x9bg\xf6bS|Lq\xe9\xee\x15"
    b"Da\xb2f@\x97\xea\xa9\xf5\xbc7\xce]\x9f\x9bG\x87\xbe\r&\xf1e4\xf6"
    b"\xc6\xa8w\xf4\xaa\x97\xd3b\x818\x15\x08\xef\x11\xb9\xe8\x9f\x8b"
    b"\xb3%\x04\xe2\xb53\xe0c30\x89\x8e\x16\xf9\xbd0"
)
SSH_CHALLENGE = (
    b"\x00\x00\x00 \n\xd9\x8dp\xe3c\xf0\x1b\xf4\xce\x0f\xf5"
    b"\x94L2\xe9\xd4\xd1\x18\xf7Lf\xfe\xb3d\xa5\x80Wlk\x06"
    b"\xdd2\x00\x00\x00\x04rhtb\x00\x00\x00\x0essh-connection"
    b"\x00\x00\x00\tpublickey\x01\x00\x00\x00\x0bssh-ed25519"
    b"\x00\x00\x003\x00\x00\x00\x0bssh-ed25519\x00\x00\x00 "
    b"\x19\x92\xb9\x10>9a[[\x8e5IOR\xffA\xf13\xdb\xf5h\xc9]"
    b"\x80\x12~\xa5:[N]\xba"
)
ED25519_SIGNATURE = (
    b"\xec\x10@)\xe5\xc4\xb9[\xacts\x1f\xc2"
    b"\x9b9\xd1\x8eA ,W\xbf\x13\xc9\x14\xa2\x9c\xdb}e'\x0e\x8c"
    b"\xcfr\xa2\x9d}\x12\xa3\r\xd3\xf6Hl$\x7f@\xf2\x12\xe8O\x89"
    b"\xe4F9\x93\xdfw+btM\x06"
)
ECDSA_SIGNATURE_NEG = (
    b"&t+>\xb6\xc6\xe6\xf2\x1b\x04s9.\x08\xb5t"
    b"\x92\xe4\xa8$\xb7Ry\\3O;zaB\xfd)m\xda\xf5\xb9\x1f\x90\xb6\x1bTE"
    b"\x99%&\x1fw\xe3\xc2,-4\xdb\x87\xa1\x98\xbd\xb8S\xa3\xd5\x12Ek"
)
ECDSA_SIGNATURE = (
    b"\xe1\x1f\x08\x90\xda\xca\xb7\x9a\xe2\xee\xaaa<"
    b"\x91c)\xa8K\x0e&m\xcc\xdd\x137\x80q\xa7P\xd7\xd8\xd0\xc2\x9a\xbfSN"
    b"\x99F'\xe4\xe7\xb0Y\x07x\xe5z\xfa\xf3>\xcf\x1e\xcbr\xf2\xac\x85\xed"
    b"\xec0\x9c\xaf\xfe"
)
SSH_SIGNING_REQUEST = (
    b"\x00\x00\x00h\x00\x00\x00\x13ecdsa-sha2-nistp256"
    b"\x00\x00\x00\x08nistp256\x00\x00\x00A\x04(\xb7\x9fI\xee\x81~\x83\xe5g\xd0"
    b"\xff\n\xe0\xcf&w\xd6\xc7\x17 \xf9\x98\xad.>/S\x15\xdb\x8d;\x18\n\x85k\x19"
    b"\xa6gE\x98^b*Y\x9ch#\xaddO`\x9d>\x02\x02\xd0\xa4\x8b\x87\x95\x12{\xed\x00"
    b"\x00\x04\x00X\xf3\xca\xcd\x1c2\x16\xed\xb6\xb9\n\xde\x9b\xa1\x17BM6\xbb\x91"
    b'\x1e\x9a\x90\xe8\xb1\xdd\xa9W\x83\xee\xc4\xfeM\xd3\xdf&%"\xb5\n\xd6\xcb\xcc'
    b"\xf44\xf7(\x84i\x13\xbd\xa4\xf6Np\x1f\x8c\xd5\xebX\xa2H\xd4\xcd\x9a{K\x87u"
    b"\xea\x9bX\x0c\xaf\x17N\xd0\xd2^Q4l\xf6o\xbdm\xe6\x10\xdb\xb0\xf4\x8c\xd3"
    b'\xb0\x87\xeaU\x16\xd9\n],\n~\xf4\xd7\xa6 \xfc"\xad\xb14\xf0\x9cU\xe4\x8b'
    b">y9L3d1\xcbT\xe4|\xa5\x89\x0f\x8cE\xa77\xcb\xa6\xf6\t\x86\x0e#\xd0\xa2\xb4"
    b"\x9e\xc02\x7f\xfb\xb3\xc5U\xd6<{\x0c.\xb7\xf7\xfd-\x14\xeb\xd0\xe7J\x94\xfd"
    b"\xb5B\xbb\xa8\x13\xa2\x1cD\xf3\x94\xe1\xf9\xe7\x99\xfcT\xa3\xe5\x05\xba\x17"
    b"\x03\xa0\r!\xb7\xbe\xaec\x1ax\x862Z\xec\x148\xf0\x98:j\x83_\x03\xedM\xac5`"
    b"^#\xfc<\xf9\x0e\xa1\xdf\xc2\x90\xd5\xef\x17\r\x94\xa0\x84\xe8\xdd\xe0@1\xc2"
    b"\xb6K\x00\xd4Em\x1c\xab\x05.\xf7\xac\x15%\xd2\xbd\xd1\xc0/\x14\x9d\xd5n\xd7"
    b"\xe4\xa7=\x12\t\xb2s\xd1\x19\x0f\xba\xec\xf3\xad7\xe4\x02.\xf1\x99I\xcb\xf1,"
    b"\xcc\xc1M\x17\xa0Yf\x90\xb3\x82<vv\xd3\x89\xe1\xe7\xc18\x0c \xcd;\xf11A\x8b"
    b"\xe6\x1b\xc3\xab\xb5\x8b\xdfg8U\x81\xd0\xaa\xee\x88!\xf8\xe1\xcfl\x8eE\xdd"
    b"\xad\xf5?\xc8\xfa38q\xad\x85\xb29\xa3nu\xc9\xbf\x1b\rh\x95\xd0\xc5\xce\xb6"
    b"\xdf\xcc\x9b\xee@\n\xbb^\xab\xba\x80\xe4I5L\xcf&S\xfe \x1b2\xbc\xb2-\xaf"
    b"\xac\x1b[\xfd\xae{IV\x9e\xcd\x86\xfbI\xa4\\\x16AQ1\x8e\x16\x9a\xab\x7f\x922"
    b"\x10t\xbb\xe5\xcb\xe7\xa4\xbd_\xab\xad\xf0c\x18\xce\x19m_\xa0mnc\xb6)0\xf5"
    b"\xdeF\x83\xb4\xa4\xd7{\x8e\xd24\x8c&\x17+S \x8d\xfaN\xa54\xa0\xff\x12|\xa9}"
    b"\xe36\x86O\xbe.\x15\x03\xbcx\xc9\x93\xeal\xf7)2{\xa7\x9e|t\x8fDu\xe8\x17"
    b"\xf6$\n\x18\xd9\x0el\x11@<!\xc1w(\xa0%J\x0fC\xffJ\xf6\xcb\x00\x8f\x86\x88"
    b"\xf3\xf9\xd7\x0c\x84\x1c,I\x93\xe4\xdd\xbfj\x16\x1aL\xae|0Y\x0cg.\x98a\x8b"
    b"\x80\x80[\xf7\x8c\xcb$/P\xed\xe1\x8fB\x8dCly+\xdd\xf8eE\xbey\x9b\x1e\x18^a"
    b"\xfa\xb5\xfc\xa4n\xd1\x80\xb4vm\xeb\x03k\xd1W\xec\x93\xed\x97\xd2\xa952\x04"
    b":\xc0k\xe2w\xb8\xd4\xbd\xfe\x8fI\xdd^\xac3\xd3\x01\x8c\xfc.\xf3-\x87\xde\xc4"
    b"\x8e\xa0\xc2\xf3\xef\x1e\x08\x1a\x16\x90U\x98'\x83\x14\xe1p\xed\xcd\xfa\x00"
    b'\x01\xf7c\xbc\x83\xc1^\x1bt*\xb1"\xf2\xdd\x92\x10\x96lJ\x91bP\xab\xa6\x00'
    b"\x93\xfe}\xd8\xbbP[\xcf\xb3%#p\xff\x17\x9e\xbb\xba\x88\x1d\xd0h\x85\xa4\xec"
    b"\xfb\x0b\xab|O\x99@\xdb\x1f\x9db\x86\xfe\xc2\x10^\x9c8\xd6\xaa\x03\xb5\xb1nhG"
    b"\x7f\xcb\xdf\xda\xe4<2B\x82\xd8\xb8\x00\xb0\xe7\xa2Y\xd9\xadx\xc0\xd0\x9b"
    b"\x14t23\xa04\xc9q\xb2\xee\xff\xc1\xba\xc41\xc6Ax9B\x04\x046T\xb9a,J\xefk"
    b"\xd0\xb3\xc8\x8e*\x80\xde(Y'\xe1\x84\xaf\x18\xeaNe\xed=\xf6\xc6\xce\xb4"
    b"\x1fB\x7f\xdc\x8c\xcec\x03\x19\xe2\xeeu\x08\x11?!\x95V\x9b\xa6\xaai\x18"
    b"\xe2.\xa0\x8b\xb3!\xbdf\x1f\x08\xb7re{7\\\x80\xdb\xceWu\x8f\x19\xc1\xfd?"
    b"\xfc\xad\xf6?4e\xa4U\xce\xcdN\xa81\xdf\x0b\xfa\n+&G\xb6\xb3\x07C\n0\x13"
    b"\x10\xe7j&\x16T9\xf7\xda\xe8\xad\x0e/\xc04\xfc+\xa0\xc5~\xb1\x17]\x9b\xd7"
    b"tt,\x06\xcf\xc5\x19Q\x8c\x1a\xf3\xcf\x89i/J\xbf!_\xd3\xf7\x9b\x95\xb4M\xe0"
    b"H\xa6\xc1xw\x8ad\xae{\xcegI\xd9\xa80\xc4\xb7o\xa3\xe8\xd9Ij\xd3\xa2%\xdc"
    b"\xe3m\xde\x81\xf9w\xe1\xe3\x9f\xb3t\xbf\x1f\x19b\xe0*\xca\x1c\xc94\t\x02:"
    b"\x13h;\xe7@\xbd\x81\x9d\xc1\xdc;\x97I~\x01<p\xb6{V\x02\xca|\x0c\x9e\xfe\xe9"
    b'*1\x8b\xd5lp\x94\xc4Pc\xcf\xf08("\xb2\xabW\x8b_\x00\x00\x00\x00'
)

TEST_ACCOUNT = {
    "id": "account_id",
    "username": "test-username",
    "sites": [{"name": "example-site", "url": "https://chiff.app"}],
}


def sample_ppd(
    min_length,
    max_length,
    max_consecutive=None,
    character_set_settings=None,
    position_restrictions=None,
    requirement_groups=None,
):
    character_sets = [
        {"characters": "abcdefghijklmnopqrstuvwxyz", "name": "LowerLetters"},
        {"characters": "ABCDEFGHIJKLMNOPQRSTUVWXYZ", "name": "UpperLetters"},
        {"characters": "0123456789", "name": "Numbers"},
        {"characters": ")(*&^%$#@!{}[]:;\"'?/,.<>`~|", "name": "Specials"},
    ]
    ppd_character_settings = None
    if (
        character_set_settings is not None
        or position_restrictions is not None
        or requirement_groups is not None
    ):
        ppd_character_settings = {
            "characterSetSettings": character_set_settings,
            "requirementGroups": requirement_groups,
            "positionRestrictions": position_restrictions,
        }

    properties = {
        "characterSettings": ppd_character_settings,
        "maxConsecutive": max_consecutive,
        "minLength": min_length,
        "maxLength": max_length,
    }

    ppd = {
        "characterSets": character_sets,
        "properties": properties,
        "service": None,
        "version": "1.0",
        "timestamp": time.time(),
        "url": "https://example.com",
        "redirect": None,
        "name": "Example",
    }

    return ppd


def api_call(response):
    def _api_call(*args):
        return response

    return _api_call


def get_sqs_message(message):
    return api_call({"messages": [{"body": message, "receiptHandle": "bonnie"}]})
